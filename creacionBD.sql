CREATE TABLE Ciudad (id INT AUTO_INCREMENT NOT NULL, nombre VARCHAR(100) NOT NULL, slug VARCHAR(100) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Usuario (id INT AUTO_INCREMENT NOT NULL, ciudad_id INT DEFAULT NULL, nombre VARCHAR(100) NOT NULL, apellidos VARCHAR(255) NOT NULL, email VARCHAR(255) NOT NULL, password VARCHAR(255) NOT NULL, salt VARCHAR(255) NOT NULL, direccion LONGTEXT NOT NULL, permite_email TINYINT(1) NOT NULL, fecha_alta DATETIME NOT NULL, fecha_nacimiento DATETIME NOT NULL, dni VARCHAR(9) NOT NULL, numero_tarjeta VARCHAR(20) NOT NULL, UNIQUE INDEX UNIQ_EDD889C1E7927C74 (email), INDEX IDX_EDD889C1E8608214 (ciudad_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Tienda (id INT AUTO_INCREMENT NOT NULL, ciudad_id INT DEFAULT NULL, nombre VARCHAR(100) NOT NULL, slug VARCHAR(100) NOT NULL, login VARCHAR(10) NOT NULL, password VARCHAR(255) NOT NULL, salt VARCHAR(255) NOT NULL, descripcion LONGTEXT NOT NULL, direccion LONGTEXT NOT NULL, INDEX IDX_C76AE008E8608214 (ciudad_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Oferta (id INT AUTO_INCREMENT NOT NULL, ciudad_id INT DEFAULT NULL, tienda_id INT DEFAULT NULL, nombre VARCHAR(255) NOT NULL, slug VARCHAR(255) NOT NULL, descripcion LONGTEXT NOT NULL, condiciones LONGTEXT NOT NULL, foto VARCHAR(255) NOT NULL, precio NUMERIC(10, 2) NOT NULL, descuento NUMERIC(10, 2) NOT NULL, fecha_publicacion DATETIME DEFAULT NULL, fecha_expiracion DATETIME DEFAULT NULL, compras INT NOT NULL, umbral INT NOT NULL, revisada TINYINT(1) NOT NULL, INDEX IDX_73D5CDC4E8608214 (ciudad_id), INDEX IDX_73D5CDC419BA6D46 (tienda_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Venta (oferta_id INT NOT NULL, usuario_id INT NOT NULL, fecha DATETIME NOT NULL, INDEX IDX_4E26C151FAFBF624 (oferta_id), INDEX IDX_4E26C151DB38439E (usuario_id), PRIMARY KEY(oferta_id, usuario_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE ContratoServicio (trabajador_id INT NOT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, servicio_id INT NOT NULL, categoria_id INT DEFAULT NULL, contrato_id INT DEFAULT NULL, slug VARCHAR(100) NOT NULL, descripcion VARCHAR(255) DEFAULT NULL, porciento INT NOT NULL, INDEX IDX_B2313189EC3656E (trabajador_id), INDEX IDX_B231318971CAA3E7 (servicio_id), INDEX IDX_B23131893397707A (categoria_id), INDEX IDX_B231318970AE7BF1 (contrato_id), PRIMARY KEY(trabajador_id, fechaini, fechafin, servicio_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Categoria (id INT AUTO_INCREMENT NOT NULL, nombre VARCHAR(100) NOT NULL, slug VARCHAR(100) NOT NULL, descripcion VARCHAR(255) DEFAULT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Contrato (id INT AUTO_INCREMENT NOT NULL, trabajador_id INT DEFAULT NULL, categoria_id INT DEFAULT NULL, slug VARCHAR(100) NOT NULL, descripcion VARCHAR(255) DEFAULT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, posicion VARCHAR(8) DEFAULT NULL, porciento INT NOT NULL, tipo VARCHAR(25) DEFAULT NULL, INDEX IDX_9F1F0775EC3656E (trabajador_id), INDEX IDX_9F1F07753397707A (categoria_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Absentismo (id INT AUTO_INCREMENT NOT NULL, tipo VARCHAR(25) NOT NULL, slug VARCHAR(25) NOT NULL, max NUMERIC(10, 0) NOT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Trabajador (id INT AUTO_INCREMENT NOT NULL, num_empleado VARCHAR(8) NOT NULL, nombre VARCHAR(100) NOT NULL, apellido1 VARCHAR(100) NOT NULL, apellido2 VARCHAR(100) DEFAULT NULL, dni VARCHAR(9) DEFAULT NULL, telefono VARCHAR(9) DEFAULT NULL, telefono2 VARCHAR(9) DEFAULT NULL, localidad VARCHAR(255) DEFAULT NULL, usuario VARCHAR(30) DEFAULT NULL, password VARCHAR(10) DEFAULT NULL, slug VARCHAR(255) NOT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, fecha_nacimiento DATETIME DEFAULT NULL, fecha_antiguedad DATETIME DEFAULT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE TurnoServicio (id INT AUTO_INCREMENT NOT NULL, servicio_id INT DEFAULT NULL, categoria_id INT DEFAULT NULL, turno VARCHAR(5) NOT NULL, slug VARCHAR(5) NOT NULL, descripcion VARCHAR(255) DEFAULT NULL, minimo INT NOT NULL, laborable INT NOT NULL, festivo INT NOT NULL, horasdia NUMERIC(10, 0) NOT NULL, horasnoche NUMERIC(10, 0) NOT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, INDEX IDX_C7C6331071CAA3E7 (servicio_id), INDEX IDX_C7C633103397707A (categoria_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Turno (id INT AUTO_INCREMENT NOT NULL, turno VARCHAR(5) NOT NULL, slug VARCHAR(5) NOT NULL, descripcion VARCHAR(255) DEFAULT NULL, horasdia NUMERIC(10, 0) NOT NULL, horasnoche NUMERIC(10, 0) NOT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Centro (id INT AUTO_INCREMENT NOT NULL, nombre VARCHAR(100) NOT NULL, slug VARCHAR(100) NOT NULL, fechaini DATETIME NOT NULL, fechafin DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE Servicio (id INT AUTO_INCREMENT NOT NULL, nombre VARCHAR(5) NOT NULL, slug VARCHAR(5) NOT NULL, Descripcion VARCHAR(100) DEFAULT NULL, Centro_id INT DEFAULT NULL, INDEX IDX_32F0907CAB70B504 (Centro_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE acl_classes (id INT UNSIGNED AUTO_INCREMENT NOT NULL, class_type VARCHAR(200) NOT NULL, UNIQUE INDEX UNIQ_69DD750638A36066 (class_type), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE acl_security_identities (id INT UNSIGNED AUTO_INCREMENT NOT NULL, identifier VARCHAR(200) NOT NULL, username TINYINT(1) NOT NULL, UNIQUE INDEX UNIQ_8835EE78772E836AF85E0677 (identifier, username), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE acl_object_identities (id INT UNSIGNED AUTO_INCREMENT NOT NULL, parent_object_identity_id INT UNSIGNED DEFAULT NULL, class_id INT UNSIGNED NOT NULL, object_identifier VARCHAR(100) NOT NULL, entries_inheriting TINYINT(1) NOT NULL, UNIQUE INDEX UNIQ_9407E5494B12AD6EA000B10 (object_identifier, class_id), INDEX IDX_9407E54977FA751A (parent_object_identity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE acl_object_identity_ancestors (object_identity_id INT UNSIGNED NOT NULL, ancestor_id INT UNSIGNED NOT NULL, INDEX IDX_825DE2993D9AB4A6 (object_identity_id), INDEX IDX_825DE299C671CEA1 (ancestor_id), PRIMARY KEY(object_identity_id, ancestor_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE acl_entries (id INT UNSIGNED AUTO_INCREMENT NOT NULL, class_id INT UNSIGNED NOT NULL, object_identity_id INT UNSIGNED DEFAULT NULL, security_identity_id INT UNSIGNED NOT NULL, field_name VARCHAR(50) DEFAULT NULL, ace_order SMALLINT UNSIGNED NOT NULL, mask INT NOT NULL, granting TINYINT(1) NOT NULL, granting_strategy VARCHAR(30) NOT NULL, audit_success TINYINT(1) NOT NULL, audit_failure TINYINT(1) NOT NULL, UNIQUE INDEX UNIQ_46C8B806EA000B103D9AB4A64DEF17BCE4289BF4 (class_id, object_identity_id, field_name, ace_order), INDEX IDX_46C8B806EA000B103D9AB4A6DF9183C9 (class_id, object_identity_id, security_identity_id), INDEX IDX_46C8B806EA000B10 (class_id), INDEX IDX_46C8B8063D9AB4A6 (object_identity_id), INDEX IDX_46C8B806DF9183C9 (security_identity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE Usuario ADD CONSTRAINT FK_EDD889C1E8608214 FOREIGN KEY (ciudad_id) REFERENCES Ciudad (id);
ALTER TABLE Tienda ADD CONSTRAINT FK_C76AE008E8608214 FOREIGN KEY (ciudad_id) REFERENCES Ciudad (id);
ALTER TABLE Oferta ADD CONSTRAINT FK_73D5CDC4E8608214 FOREIGN KEY (ciudad_id) REFERENCES Ciudad (id);
ALTER TABLE Oferta ADD CONSTRAINT FK_73D5CDC419BA6D46 FOREIGN KEY (tienda_id) REFERENCES Tienda (id);
ALTER TABLE Venta ADD CONSTRAINT FK_4E26C151FAFBF624 FOREIGN KEY (oferta_id) REFERENCES Oferta (id);
ALTER TABLE Venta ADD CONSTRAINT FK_4E26C151DB38439E FOREIGN KEY (usuario_id) REFERENCES Usuario (id);
ALTER TABLE ContratoServicio ADD CONSTRAINT FK_B2313189EC3656E FOREIGN KEY (trabajador_id) REFERENCES Trabajador (id);
ALTER TABLE ContratoServicio ADD CONSTRAINT FK_B231318971CAA3E7 FOREIGN KEY (servicio_id) REFERENCES Servicio (id);
ALTER TABLE ContratoServicio ADD CONSTRAINT FK_B23131893397707A FOREIGN KEY (categoria_id) REFERENCES Categoria (id);
ALTER TABLE ContratoServicio ADD CONSTRAINT FK_B231318970AE7BF1 FOREIGN KEY (contrato_id) REFERENCES Contrato (id);
ALTER TABLE Contrato ADD CONSTRAINT FK_9F1F0775EC3656E FOREIGN KEY (trabajador_id) REFERENCES Trabajador (id);
ALTER TABLE Contrato ADD CONSTRAINT FK_9F1F07753397707A FOREIGN KEY (categoria_id) REFERENCES Categoria (id);
ALTER TABLE TurnoServicio ADD CONSTRAINT FK_C7C6331071CAA3E7 FOREIGN KEY (servicio_id) REFERENCES Servicio (id);
ALTER TABLE TurnoServicio ADD CONSTRAINT FK_C7C633103397707A FOREIGN KEY (categoria_id) REFERENCES Categoria (id);
ALTER TABLE Servicio ADD CONSTRAINT FK_32F0907CAB70B504 FOREIGN KEY (Centro_id) REFERENCES Centro (id);
ALTER TABLE acl_object_identities ADD CONSTRAINT FK_9407E54977FA751A FOREIGN KEY (parent_object_identity_id) REFERENCES acl_object_identities (id);
ALTER TABLE acl_object_identity_ancestors ADD CONSTRAINT FK_825DE2993D9AB4A6 FOREIGN KEY (object_identity_id) REFERENCES acl_object_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_object_identity_ancestors ADD CONSTRAINT FK_825DE299C671CEA1 FOREIGN KEY (ancestor_id) REFERENCES acl_object_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_entries ADD CONSTRAINT FK_46C8B806EA000B10 FOREIGN KEY (class_id) REFERENCES acl_classes (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_entries ADD CONSTRAINT FK_46C8B8063D9AB4A6 FOREIGN KEY (object_identity_id) REFERENCES acl_object_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_entries ADD CONSTRAINT FK_46C8B806DF9183C9 FOREIGN KEY (security_identity_id) REFERENCES acl_security_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
